
const mp = new MercadoPago('APP_USR-15c5d1f2-b55f-40d8-81b0-1ff53674c97b', {
    locale: 'es-UY'
});
document.getElementById('checkout-btn').addEventListener("click", async ()=>{
    try {
        const orderData = {
            title: document.querySelector("product-title").innerText,
            quanty: 1,
            price: 50,
        };
        const response = await fetch("https://localhost:5500/create_preference", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(orderData)
        });
        const preference = await response.json()
        createCheckout(preference.id);
    } catch (error) {
        alert("Error");
    }
});
 
//creamos el boton para MP
const createCheckoutButton = (preferenceId) => {
    const bricksBuilder = mp.bricks();

    const renderComponent = async () => {
        if (window.checkoutButton) window.checkoutButton.unmount();
        
        await bricksBuilder.create("wallet", "wallet_container", {
            initialization: {
                preferenceId: preferenceId,
            },
         });
    }
    renderComponent();

}

const checkoutButton = document.createElement("div");
checkoutButton.className = "checkout-button";
checkoutButton.innerHTML = `
    <div id="wallet_container"></div>
`;